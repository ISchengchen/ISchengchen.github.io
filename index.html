<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/slark.jpeg?v=5.1.1" />






<meta name="description" content="rua! rua! rua!">
<meta property="og:type" content="website">
<meta property="og:title" content="Slark">
<meta property="og:url" content="http://slark.info/index.html">
<meta property="og:site_name" content="Slark">
<meta property="og:description" content="rua! rua! rua!">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Slark">
<meta name="twitter:description" content="rua! rua! rua!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://slark.info/"/>





  <title>Slark</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Slark</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">coding and thinking</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/14/pythonæè¿°å™¨/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/14/pythonæè¿°å™¨/" itemprop="url">pythonæè¿°å™¨</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-14T17:02:57+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="å®šä¹‰"><a href="#å®šä¹‰" class="headerlink" title="å®šä¹‰"></a>å®šä¹‰</h3><p>æè¿°å™¨æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œè®¿é—®æ§åˆ¶è¢«æè¿°å™¨åè®®çš„æ–¹æ³•é‡å†™ï¼Œè¿™äº›æ–¹æ³•æ˜¯<code>__get__()</code>ï¼Œ<code>__set__()</code>å’Œ<code>__delete__()</code>ï¼Œæœ‰è¿™äº›æ–¹æ³•çš„å¯¹è±¡å«åšæè¿°å™¨</p>
<h3 id="è®¿é—®æ§åˆ¶"><a href="#è®¿é—®æ§åˆ¶" class="headerlink" title="è®¿é—®æ§åˆ¶"></a>è®¿é—®æ§åˆ¶</h3><p>åœ¨è®²æè¿°å™¨ä¹‹å‰ï¼Œå…ˆèŠä¸€ä¸‹pythonå±æ€§çš„è®¿é—®æ§åˆ¶ï¼Œä¼šæ¶‰åŠåˆ°pythonçš„å‡ ä¸ªé­”æœ¯æ–¹æ³•ã€‚<br><code>__getattribute__</code>:è·å–å±æ€§éƒ½ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆæ–°å¼ç±»ä¸­ï¼Œ2.Xç»§æ‰¿object,3.xéƒ½æ˜¯æ–°å¼ç±»ï¼‰<br><code>__getattr__</code>:å½“è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„å±æ€§çš„æ—¶å€™ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚<br>ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">1</span>]: <span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">   ...:     <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, item)</span>:</span></div><div class="line">   ...:         <span class="keyword">return</span> <span class="number">1</span></div><div class="line">   ...:</div><div class="line"></div><div class="line">In [<span class="number">2</span>]: a = A()</div><div class="line"></div><div class="line">In [<span class="number">3</span>]: a.x</div><div class="line">Out[<span class="number">3</span>]: <span class="number">1</span></div></pre></td></tr></table></figure>
<p>æ—¢ç„¶<code>__getattribute__</code>æ˜¯è·å–å±æ€§çš„é»˜è®¤è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡é‡å†™<code>__getattribute__</code>æ¥å¯¹å±æ€§è·å–è¿›è¡Œè‡ªå®šä¹‰è¡Œä¸ºï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯åœ¨<code>__getattribute__</code>å†…éƒ¨è¿›è¡Œå±æ€§è·å–çš„æ—¶å€™ï¼Œä¸€å®šè¦è°ƒç”¨çˆ¶ç±»çš„<code>__getattribute__</code>ï¼Œä¸ç„¶å°±é™·å…¥æ— é™å¾ªç¯äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattribute__</span><span class="params">(self, item)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.item</div><div class="line">A().<span class="string">'xx'</span></div><div class="line">RuntimeError: maximum recursion depth exceeded</div></pre></td></tr></table></figure>
<p><code>__getattribute__</code>è·å–å±æ€§çš„é¡ºåºæ˜¯ï¼Œå…ˆä»å®ä¾‹çš„<strong>dict</strong>ä¸­æ‰¾ï¼Œç„¶åæ˜¯ç±»ï¼Œçˆ¶ç±»çš„<strong>dict</strong>ä¸­æ‰¾ã€‚<br>å¦‚æœä»è¿™ä¸ªè®¿é—®æ§åˆ¶çš„è§’åº¦çœ‹ï¼Œç›®å‰æˆ‘ä»¬çš„æ‰‹æ®µéƒ½æ˜¯é’ˆå¯¹æ‰€æœ‰å±æ€§çš„ï¼Œä¼¼ä¹ç¼ºå°‘ä¸€ç§æ›´ç»†ç²’åº¦çš„æ§åˆ¶ï¼Œæè¿°å™¨å°±å¯ä»¥è®©æˆ‘ä»¬é’ˆå¯¹ç‰¹å®šå±æ€§è¿›è¡Œæ“ä½œã€‚</p>
<h3 id="æè¿°å™¨çš„è°ƒç”¨"><a href="#æè¿°å™¨çš„è°ƒç”¨" class="headerlink" title="æè¿°å™¨çš„è°ƒç”¨"></a>æè¿°å™¨çš„è°ƒç”¨</h3><p>å¯¹äºä¸€ä¸ªå®ä¾‹obj,å½“æˆ‘ä»¬è°ƒç”¨obj.dçš„æ—¶å€™ï¼Œæ ¹æ®dçš„æè¿°å™¨ç±»å‹<br>ï¼ˆå®ç°äº†<code>__get__</code>å’Œ<code>__set__</code>çš„æ˜¯èµ„æ–™æè¿°å™¨ï¼Œåªå®ç°äº†<code>__set__</code>æ˜¯éèµ„æ–™æè¿°å™¨ï¼‰<br>æœ‰ä»¥ä¸‹ä¼˜å…ˆçº§ï¼šèµ„æ–™æè¿°å™¨&gt;å®ä¾‹å˜é‡&gt;éèµ„æ–™æè¿°å™¨&gt;<code>__getattr__</code><br>å¦‚æœè°ƒç”¨äº†æè¿°å™¨ï¼Œé‚£ä¹ˆ<code>__getattribute__</code>ä¼šæŠŠobj.xå˜æˆ<br>type(obj).<strong>dict</strong>[â€˜xâ€™].<strong>get</strong>(obj, type(obj))<br>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬é‡å†™äº†<code>__getattribute__</code>æ–¹æ³•ä¼šé˜»æ­¢æè¿°å™¨çš„è°ƒç”¨</p>
<h3 id="æè¿°å™¨çš„åº”ç”¨"><a href="#æè¿°å™¨çš„åº”ç”¨" class="headerlink" title="æè¿°å™¨çš„åº”ç”¨"></a>æè¿°å™¨çš„åº”ç”¨</h3><h5 id="property"><a href="#property" class="headerlink" title="property"></a>property</h5><p>å¹³æ—¶æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™åº”è¯¥æ²¡å°‘ç”¨propertyè¿™ä¸ªè£…é¥°å™¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class person(object):</div><div class="line">    </div><div class="line">    def __init__(self, first_name, last_name):</div><div class="line">    self.first_name = first_name</div><div class="line">    self.last_name = last_name</div><div class="line">    </div><div class="line">    @property</div><div class="line">    def full_name(self):</div><div class="line">        return &apos;&#123;&#125;.&#123;&#125;&apos;.format(first_name, last_name)</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸€ä¸ªpythonçš„ç­‰ä»·å®ç°(æ¥è‡ªpythonçš„doc)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">class property(object):</div><div class="line">    &quot;Emulate PyProperty_Type() in Objects/descrobject.c&quot;</div><div class="line"></div><div class="line">    def __init__(self, fget=None, fset=None, fdel=None, doc=None):</div><div class="line">        self.fget = fget</div><div class="line">        self.fset = fset</div><div class="line">        self.fdel = fdel</div><div class="line">        self.__doc__ = doc</div><div class="line"></div><div class="line">    def __get__(self, obj, objtype=None):</div><div class="line">        if obj is None:</div><div class="line">            return self</div><div class="line">        if self.fget is None:</div><div class="line">            raise AttributeError, &quot;unreadable attribute&quot;</div><div class="line">        return self.fget(obj)</div><div class="line"></div><div class="line">    def __set__(self, obj, value):</div><div class="line">        if self.fset is None:</div><div class="line">            raise AttributeError, &quot;can&apos;t set attribute&quot;</div><div class="line">        self.fset(obj, value)</div><div class="line"></div><div class="line">    def __delete__(self, obj):</div><div class="line">        if self.fdel is None:</div><div class="line">            raise AttributeError, &quot;can&apos;t delete attribute&quot;</div><div class="line">        self.fdel(obj)</div><div class="line"></div><div class="line">    def getter(self, fget):</div><div class="line">        return type(self)(fget, self.fset, self.fdel, self.__doc__)</div><div class="line"></div><div class="line">    def setter(self, fset):</div><div class="line">        return type(self)(self.fget, fset, self.fdel, self.__doc__)</div><div class="line"></div><div class="line">    def deleter(self, fdel):</div><div class="line">        return type(self)(self.fget, self.fset, fdel, self.__doc__)</div></pre></td></tr></table></figure>
<p>è¿™é‡Œpropertyè¢«ä½œä¸ºä¸€ä¸ªç±»è£…é¥°å™¨ä½¿ç”¨ï¼Œæœ¬æ–‡ä¸å¯¹è£…é¥°å™¨è¿›è¡Œå±•å¼€ï¼Œå¯ä»¥ç†è§£ä¸ºproperty(full_name),ç„¶åfull_nameå°±æ˜¯ä¸€ä¸ªpropertyç±»å‹çš„ä¸€ä¸ªå®ä¾‹ï¼Œç”±äºpropertyå®ç°äº†<code>__get__</code>,<code>__set__</code> æ‰€ä»¥æ­¤æ—¶full_nameæ˜¯ä¸€ä¸ªèµ„æ–™æè¿°å™¨ï¼Œä¼˜å…ˆçº§æœ€é«˜ã€‚ä»propertyçš„<strong>init</strong>æ–¹æ³•æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ­¤æ—¶è¢«propertyè£…é¥°çš„full_nameæ–¹æ³•å…¶å®å°±æ˜¯fget,è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¹³æ—¶åœ¨å¯¹propertyè¿›è¡Œsetæ“ä½œçš„æ—¶å€™éœ€è¦åŠ ä¸Šå¦‚ä¸‹ä»£ç </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@full_name.setter</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">full_name</span><span class="params">(self, full_name)</span>:</span></div><div class="line">    self.full_name = full_name</div></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™è®¾ç½®äº†fsetæ–¹æ³•ä¸ä¼šæ‰§è¡Œå¦‚ä¸‹ä»£ç äº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> self.fset <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">           <span class="keyword">raise</span> AttributeError, <span class="string">"can't set attribute"</span></div></pre></td></tr></table></figure>
<p>######cached_property</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func, name=None, doc=None)</span>:</span></div><div class="line">    self.__name__ = name <span class="keyword">or</span> func.__name__</div><div class="line">    self.__module__ = func.__hmodule__</div><div class="line">    self.__doc__ = doc <span class="keyword">or</span> func.__doc__</div><div class="line">    self.func = func</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__set__</span><span class="params">(self, obj, value)</span>:</span></div><div class="line">    obj.__dict__[self.__name__] = value</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, obj, type=None)</span>:</span></div><div class="line">    <span class="keyword">if</span> obj <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> self</div><div class="line">    value = obj.__dict__.get(self.__name__, _missing)</div><div class="line">    <span class="keyword">if</span> value <span class="keyword">is</span> _missing:</div><div class="line">        value = self.func(obj)</div><div class="line">        obj.__dict__[self.__name__] = value</div><div class="line">    <span class="keyword">return</span> value</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨propertyå°±å·²ç»å®ç°äº†æ‡’åŠ è½½ï¼ˆåªæœ‰è°ƒç”¨obj.xçš„æ—¶å€™æ‰ä¼šæ‰§è¡Œxå†…éƒ¨çš„ä»£ç ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¡ºå¸¦æŠ½å‡ºflaskçš„cached_propertyæ¥è®²å¦‚ä½•å®ç°xç»“æœçš„ç¼“å­˜ã€‚å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠç»“æœæ”¾åˆ°å®ä¾‹çš„<strong>dict</strong>é‡Œé¢ï¼Œæ¯æ¬¡<strong>get</strong>çš„æ—¶å€™å…ˆå»å®ä¾‹çš„<strong>dict</strong>é‡Œæ‰¾ï¼Œå¦‚æœmiss,é‚£ä¹ˆå†å»æ‰§è¡Œxã€‚æ‰€ä»¥è¯´ï¼Œå¯¹äºèµ„æ–™æè¿°å™¨ï¼Œæ˜¯å¯ä»¥è¦†ç›–å®ä¾‹å±æ€§çš„ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/14/python-localcacheçš„ä¸€äº›å®ç°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/14/python-localcacheçš„ä¸€äº›å®ç°/" itemprop="url">python localcacheçš„ä¸€äº›å®ç°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-14T11:12:50+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/11/raftè®ºæ–‡é˜…è¯»ç¬”è®°/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/raftè®ºæ–‡é˜…è¯»ç¬”è®°/" itemprop="url">raftè®ºæ–‡é˜…è¯»ç¬”è®°</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-11T11:54:08+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ä¸€.é€‰ä¸¾è¿‡ç¨‹</p>
<p>when:<br>å¦‚æœä¸€ä¸ªfollowerèŠ‚ç‚¹åœ¨ä¸€æ®µæ—¶é—´ï¼ˆelection timeoutï¼‰å†…æ²¡æœ‰æ”¶åˆ°leaderçš„å¿ƒè·³AppendEntries RPC(è¿™ä¸ªrpcé‡Œé¢ä¸å¸¦æœ‰log),é‚£ä¹ˆå®ƒå°±ä¼šå‘èµ·é€‰ä¸¾<br>how:<br>followerèŠ‚ç‚¹å…ˆincreaseè‡ªå·±çš„term,ç„¶åæŠŠè‡ªå·±æ ‡è®°ä¸ºcandidate,æŠ•ç¥¨è‡ªå·±ï¼Œç„¶åå‘æ‰€æœ‰èŠ‚ç‚¹å‘å‡ºä¸€ä¸ªRequestVoteçš„rpc</p>
<p>ä¸‰ç§ç»“æœï¼š</p>
<ol>
<li>è·å¾—å¤§å¤šæ•°äººçš„voteï¼Œ èµ¢å¾—é€‰ä¸¾ï¼Œç„¶åå‘æ‰€æœ‰èŠ‚ç‚¹å‘é€å¿ƒè·³ï¼Œç¡®è®¤è‡ªå·±çš„leaderåœ°ä½ã€‚</li>
<li>æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹å‘æ¥çš„å¿ƒè·³ï¼ˆè¡¨æ˜è¯¥èŠ‚ç‚¹å®£å¸ƒæˆä¸ºleaderï¼‰ï¼Œæ¯”è¾ƒå¿ƒè·³çš„termï¼Œå¦‚æœå¤§äºç­‰äºè‡ªå·±çš„termï¼Œé‚£ä¹ˆæ‰¿è®¤é€‰ä¸¾ç»“æœï¼Œå¦åˆ™ä¿æŒcandidateçŠ¶æ€ã€‚</li>
<li>åœ¨ä¸€ä¸ªtermå†…ï¼Œ æ²¡æœ‰èŠ‚ç‚¹è·å–å¤šæ•°ç¥¨ ï¼Œé€‰ä¸¾æµäº§ï¼Œincreaseè‡ªå·±çš„termï¼Œå‘èµ·ä¸‹ä¸€è½®çš„é€‰ä¸¾ï¼Œéœ€è¦é¢å¤–æªæ–½ä¿è¯è¿™ç§æƒ…å†µä¸ä¼šæ— é™å¾ªç¯ã€‚</li>
</ol>
<p>äºŒ.æ—¥å¿—å¤åˆ¶<br>leaderä¼šç»´æŒæ¯ä¸ªfollowerçš„ nextIndexæ¥è¡¨æ˜leaderéœ€è¦å‘followerå‘é€çš„ä¸‹ä¸€ä¸ªlog entryçš„indexã€‚<br>åœ¨ä¸€ä¸ªèŠ‚ç‚¹åˆšé€‰ä¸¾ä¸ºleaderçš„æ—¶å€™ï¼Œæ‰€æœ‰çš„nextIndexè¢«åˆå§‹åŒ–ä¸ºè‡ªå·±çš„æœ€åä¸€æ¡log entryã€‚ åœ¨leaderå‘é€AppendEntries RPCçš„æ—¶å€™ï¼Œ<br>å¦‚æœfollowerçš„logä¸€è‡´æ€§æ£€æŸ¥ä¸é€šè¿‡ï¼Œè¯´æ˜leaderéœ€è¦å‡å°å¯¹è¯¥followerçš„nextIndexï¼ˆæ¯æ¬¡å‡1ï¼‰,å¤šæ¬¡è¿™ä¸ªè¿‡ç¨‹åï¼Œä¼šæ‰¾åˆ°åˆé€‚çš„nextIndex,å¹¶ä¸”ä¿æŒleaderå’Œ<br>followerçš„ä¸€è‡´æ€§ã€‚<br>å¾ˆæ˜æ˜¾ï¼Œè¿™æ ·çš„åšæ³•å¯èƒ½ä¼šå¯¼è‡´rpcæ¬¡æ•°è¿‡å¤šï¼Œæ‰€ä»¥æœ‰ä¸ªä¼˜åŒ–æ‰‹æ®µï¼šæ¯æ¬¡å‡å°çš„æ˜¯æ•´ä¸ªtermçš„entryæ•°ç›®ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡rpcå‡å°ä¸€ä¸ªentryã€‚</p>
<p>ä¸‰.å®‰å…¨æ€§</p>
<p>åœ¨æ—¥å¿—å¤åˆ¶ä¸­ï¼Œå®Œå…¨æ˜¯æ ¹æ®leaderçš„æ—¥å¿—è¿›è¡Œå¤åˆ¶çš„ï¼Œå›è¦†ç›–followerï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæœºåˆ¶ä¿è¯leaderçš„æ—¥å¿—æ˜¯å®Œæ•´çš„ï¼ˆåŒ…å«äº†ä¹‹å‰æ‰€æœ‰termçš„æ—¥å¿—<br>ä¹Ÿå°±æ˜¯ <code>Leader Completeness Property</code></p>
<ol>
<li><p>é€‰ä¸¾è¿‡ç¨‹çš„é™åˆ¶<br>åœ¨æ‰€æœ‰çš„leader_basedçš„ä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œleaderæœ€ç»ˆè‚¯å®šæ˜¯è¦æ‹¥æœ‰å…¨é‡committedæ—¥å¿—çš„ã€‚å¯ä»¥åœ¨é€‰ä¸¾çš„æ—¶å€™æ ‡è®°leaderçš„ç¼ºå¤±æ—¥å¿—ï¼Œç„¶åå†é€‰ä¸¾è¿‡ç¨‹ä¸­æˆ–è€…é€‰ä¸¾ç»“æŸå<br>å°†æ—¥å¿—ä¼ åˆ°leaderï¼Œä½†æ˜¯raftå°†æ‹¥æœ‰å…¨é‡æ—¥å¿—ä½œä¸ºå¯ä»¥è¢«é€‰ä¸¾ä¸ºleaderå…ˆå†³æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯åœ¨é€‰ä¸¾çš„RequestVote Rpc ä¸­å¸¦ä¸Šcandidateçš„æ—¥å¿—ä¿¡æ¯ï¼Œç„¶å<br>æŠ•ç¥¨è€…ä¼šå¦å†³æ‰æ—¥å¿—è½åäºè‡ªå·±çš„candidateã€‚<br>æ¯”è¾ƒçš„è¿‡ç¨‹æ ¹æ®termå’Œindex,ä¼˜å…ˆæ¯”è¾ƒterm,ç„¶åæ¯”è¾ƒindex</p>
</li>
<li><p>Committing entries from previous termsï¼ˆæŒ‡ä¸æäº¤ä¹‹å‰termçš„log entryï¼‰</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/08/pipenvåˆä½“éªŒ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/08/pipenvåˆä½“éªŒ/" itemprop="url">pipenvåˆä½“éªŒ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-08T16:58:22+08:00">
                2018-06-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>ç›¸ä¿¡å¤§å¤šæ•°pythonå¼€å‘è€…éƒ½æ¥è§¦è¿‡pip+virtualenvçš„åŒ…ç®¡ç†å’Œè™šæ‹Ÿç¯å¢ƒç®¡ç†æ–¹æ¡ˆã€‚</p>
<h3 id="pip-virtualenv"><a href="#pip-virtualenv" class="headerlink" title="pip+virtualenv"></a>pip+virtualenv</h3><p>è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬å…ˆæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒ(å®‰è£…äº†virtualenvwrapperè¿™ä¸ªwrapperå¯ä»¥è®©æ“ä½œæ›´ç®€å•)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">âœ  ~ mkvirtualenv test</div><div class="line">Using base prefix &apos;/Library/Frameworks/Python.framework/Versions/3.6&apos;</div><div class="line">New python executable in /Users/Edwin/.virtualenvs/test/bin/python3.6</div><div class="line">Also creating executable in /Users/Edwin/.virtualenvs/test/bin/python</div><div class="line">Installing setuptools, pip, wheel...done.</div><div class="line">(test) âœ  ~</div></pre></td></tr></table></figure></p>
<p>ç„¶åé€šè¿‡requirement.txtæ–‡ä»¶æ¥ç®¡ç†ä¾èµ–<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(test) âœ  ~ pip install -r requirements.txt</div></pre></td></tr></table></figure></p>
<p>åˆ‡æ¢è™šæ‹Ÿç¯å¢ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(test) âœ  ~ workon slark</div><div class="line">(slark)âœ  ~</div></pre></td></tr></table></figure>
<p> è¿™ä¸ªæ–¹æ¡ˆå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚ï¼š<br> 1.ä¾èµ–éœ€è¦æ‰‹åŠ¨æ›´æ–°åˆ°requirem.txtï¼Œæ¥ä¿æŒå¤šä¸ªç¯å¢ƒçš„ä¾èµ–ä¸€è‡´<br> 2.å¦‚æœä¸åŒç¯å¢ƒä¾èµ–ä¸åŒè¦ä½¿ç”¨å¤šä¸ªrequirement.txtï¼Œæ¯”å¦‚æµ‹è¯•å’Œçº¿ä¸Šï¼Œé‚£ä¹ˆä¸€èˆ¬ä¼šè¦ç”¨requirement.txtå’Œdev_requirement.txt<br> 3.åˆ é™¤ä¾èµ–çš„è¯ä¸èƒ½åˆ é™¤ä¾èµ–çš„ä¾èµ–ï¼ˆæ¯”è¾ƒç»•ï¼‰</p>
<h3 id="pipenv"><a href="#pipenv" class="headerlink" title="pipenv"></a>pipenv</h3><p>æ—©å°±å¬è¯´requests ä½œè€… Kenneth Reitzæäº†ä¸€å¥—æ–°çš„ä¾èµ–ç®¡ç†å·¥å…·ï¼Œä»Šå¤©å…´è‡´æ¥äº†å°±æŠ˜è…¾ä¸€æ³¢ã€‚<br>pip installåœ¨ä¸€ä¸ªç©ºç›®å½•è‡ªåŠ¨åˆ›å»º Pipfileå’ŒPipfile.lock,<br>å¯ä»¥ â€“python 2.7.14ç­‰æ¥æŒ‡å®šä½¿ç”¨å“ªä¸ªpythonç‰ˆæœ¬æ¥åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">âœ  ~ mkdir pipenv_test</div><div class="line">âœ  ~ cd pipenv_test</div><div class="line">âœ  pipenv_test pipenv install</div><div class="line">Creating a virtualenv for this projectâ€¦</div><div class="line">Using /Library/Frameworks/Python.framework/Versions/3.6/bin/python3.6 (3.6.0) to create virtualenvâ€¦</div><div class="line">â ‹Already using interpreter /Library/Frameworks/Python.framework/Versions/3.6/bin/python3.6</div><div class="line">Using base prefix &apos;/Library/Frameworks/Python.framework/Versions/3.6&apos;</div><div class="line">New python executable in /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python3.6</div><div class="line">Also creating executable in /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python</div><div class="line">Installing setuptools, pip, wheel...done.</div><div class="line"></div><div class="line">Virtualenv location: /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE</div><div class="line">Creating a Pipfile for this projectâ€¦</div><div class="line">Pipfile.lock not found, creatingâ€¦</div><div class="line">Locking [dev-packages] dependenciesâ€¦</div><div class="line">Locking [packages] dependenciesâ€¦</div><div class="line">Updated Pipfile.lock (ca72e7)!</div><div class="line">Installing dependencies from Pipfile.lock (ca72e7)â€¦</div><div class="line">  ğŸ   â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰ 0/0 â€” 00:00:00</div><div class="line">To activate this project&apos;s virtualenv, run the following:</div><div class="line"> $ pipenv shell</div><div class="line">âœ  pipenv_test</div></pre></td></tr></table></figure>
<p>pipenv shellæ¿€æ´»è™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">âœ  pipenv_test pipenv shell</div><div class="line">Spawning environment shell (/bin/zsh). Use &apos;exit&apos; to leave.</div><div class="line">. /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/activate</div><div class="line">âœ  pipenv_test . /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/activate</div><div class="line">(pipenv_test-e7bT0qHE) âœ  pipenv_test</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ä¸€ä¸‹æ­¤æ—¶pythonå·²ç»æŒ‡å‘è™šæ‹Ÿç¯å¢ƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(pipenv_test-e7bT0qHE) âœ  pipenv_test which python</div><div class="line">/Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python</div><div class="line">(pipenv_test-e7bT0qHE) âœ  pipenv_test</div></pre></td></tr></table></figure>
<p>å°è¯•å®‰è£…ä¸€ä¸‹grpcio</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(pipenv_test-e7bT0qHE) âœ  pipenv_test pipenv install grpcio</div><div class="line">Installing grpcioâ€¦</div><div class="line">Collecting grpcio</div><div class="line">  Using cached https://files.pythonhosted.org/packages/68/57/da122cbfc1b7815381480b23044fff06b90f58c1be9310e68c2d6b1d623c/grpcio-1.12.1-cp36-cp36m-macosx_10_7_intel.whl</div><div class="line">Collecting six&gt;=1.5.2 (from grpcio)</div><div class="line">  Using cached https://files.pythonhosted.org/packages/67/4b/141a581104b1f6397bfa78ac9d43d8ad29a7ca43ea90a2d863fe3056e86a/six-1.11.0-py2.py3-none-any.whl</div><div class="line">Installing collected packages: six, grpcio</div><div class="line">Successfully installed grpcio-1.12.1 six-1.11.0</div><div class="line"></div><div class="line">Adding grpcio to Pipfile&apos;s [packages]â€¦</div><div class="line">Pipfile.lock (ca72e7) out of date, updating to (75c298)â€¦</div><div class="line">Locking [dev-packages] dependenciesâ€¦</div><div class="line">Locking [packages] dependenciesâ€¦</div><div class="line">Updated Pipfile.lock (75c298)!</div><div class="line">Installing dependencies from Pipfile.lock (75c298)â€¦</div><div class="line">  ğŸ   â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰â–‰ 2/2 â€” 00:00:00</div><div class="line">(pipenv_test-e7bT0qHE) âœ  pipenv_test</div></pre></td></tr></table></figure>
<p>Pipfile.lockä¸Šè®°å½•äº†grocioçš„hashã€‚</p>
<p>è²Œä¼¼pipenvç°åœ¨è¿˜ä¸å¯ä»¥å¸è½½ä¾èµ–çš„ä¾èµ–ï¼Œä½†æ˜¯å› ä¸º pipenv graph â€“json æä¾›äº†è¯¦ç»†çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä¸€äº›è„šæœ¬å®ç°ã€‚</p>
<p>æœ€åé™„ä¸Šä¸€ä¸ªpipenvçš„pdfæ–‡æ¡£ï¼š<a href="https://media.readthedocs.org/pdf/pipenv/stable/pipenv.pdf" target="_blank" rel="external">https://media.readthedocs.org/pdf/pipenv/stable/pipenv.pdf</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/04/TCP-keepaliveä¸http-keepalive/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/TCP-keepaliveä¸http-keepalive/" itemprop="url">TCP keepaliveä¸http keepalive</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-04T18:33:31+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>è®¡ç®—æœºé‡Œæœ‰å¾ˆå¤šæœ¯è¯­å¬ç€ä¸€æ ·ï¼Œç„¶è€Œå®é™…å†…å®¹ï¼ˆæ¯”å¦‚ä¸€è‡´æ€§ï¼Œåˆ°å¤„éƒ½æ˜¯ä¸€è‡´æ€§ï¼Œç„¶è€Œè¡¨è¾¾çš„æ˜¯å®Œå…¨ä¸åŒçš„æ„æ€ï¼‰å·®åˆ«å¾ˆå¤§ï¼Œæœ¬æ–‡èŠä¸€ä¸‹HTTPçš„keep-alive å’ŒTCPçš„keep-aliveï¼Œä¹Ÿè®¸æœ‰åŒå­¦è¦è¯´äº†ã€‚ã€‚ã€‚å•Šï¼åŸæ¥è¿™ä¸¤ä¸ªä¸æ˜¯ä¸€ä¸ªä¸œè¥¿ï¼Ÿ</p>
<h3 id="TCP-keep-alive"><a href="#TCP-keep-alive" class="headerlink" title="TCP keep-alive"></a>TCP keep-alive</h3><p>å…ˆæ¥çœ‹TCPçš„keep-aliveï¼Œå…¶å®ç›¸å½“äºä¸€ä¸ªå¿ƒè·³æœºåˆ¶ï¼Œåœ¨ä¸€ä¸ªTCPé“¾æ¥é•¿æ—¶é—´æ²¡æœ‰æ•°æ®å‘é€æ—¶ï¼Œä¼šè‡ªåŠ¨å‘ä¸€ä¸ªç©ºæ•°æ®æŠ¥æ–‡å‘è¿‡å»ï¼Œå¦‚æœå¯¹æ–¹æ²¡æœ‰å“åº”ï¼Œå¹¶ä¸”é‡è¯•å¤šæ¬¡ä»¥åå¯ä»¥è®¤ä¸ºé“¾æ¥ä¸¢å¤±ã€‚<br>linuxå†…æ ¸ä¸­æœ‰ä¸‰ä¸ªå‚æ•°å½±å“keep-aliveè¡Œä¸ºã€‚<br>1.net.ipv4.tcpkeepaliveintvl = 75<br>è¡¨ç¤ºä¸¤æ¬¡é‡è¯•ä¹‹é—´çš„æ—¶é—´é—´éš”<br>2.net.ipv4.tcpkeepaliveprobes = 9<br>è¡¨ç¤ºé‡è¯•æ¬¡æ•°<br>3.net.ipv4.tcpkeepalivetime = 7200<br>è¡¨ç¤ºç©ºé—²å¤šå°‘æ—¶é—´ä»¥åå¼€å§‹å‘é€å¿ƒè·³åŒ…</p>
<p>å¯¹åº”TCP socketä¸­<br>TCPKEEPCNT: è¦†ç›– tcpkeepaliveprobes<br>TCPKEEPIDLE: è¦†ç›– tcpkeepalivetime<br>TCPKEEPINTVL: è¦†ç›– tcpkeepalive_intvl<br>TCP socketä¸­é»˜è®¤ä¸æ‰“å¼€keepalive,éœ€è¦è®¾ç½®SO_KEEPALIVEé€‰é¡¹</p>
<h3 id="HTTP-keep-alive"><a href="#HTTP-keep-alive" class="headerlink" title="HTTP keep-alive"></a>HTTP keep-alive</h3><p>httpçš„keep-aliveçš„ç›®çš„æ˜¯å»¶é•¿TCPè¿æ¥çš„å­˜æ´»æ—¶é—´,ä»è€Œåœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå‘é€å¤šä¸ªHTTPè¯·æ±‚ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä¸€ä¸ªhttpè¯·æ±‚å®Œæˆæˆ‘å°±æ–­å¼€TCPè¿æ¥ï¼Œä½†æ˜¯åœ¨è®¾ç½®keep-aliveä»¥åï¼ˆhttp1.1é»˜è®¤å¼€å¯ï¼‰ï¼Œå°±ä¼šç»§ç»­ä¿æŒè¿™ä¸ªè¿æ¥keepalive_timeoutæ—¶é—´ã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/04/mysqlæ‰§è¡Œè®¡åˆ’å¤‡å¿˜/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/mysqlæ‰§è¡Œè®¡åˆ’å¤‡å¿˜/" itemprop="url">mysqlæ‰§è¡Œè®¡åˆ’å¤‡å¿˜</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-06-04T16:11:13+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>åœ¨åˆ†æsqlæ‰§è¡Œæƒ…å†µçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šç”¨åˆ°explainè¯­å¥ã€‚å› ä¸ºå†…å®¹æ¯”è¾ƒçç¢ï¼Œç‰¹åœ¨æ­¤è®°å½•ä¸€ä¸‹ã€‚</p>
<h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>å¾ˆç®€å•ï¼Œåœ¨sqlè¯­å¥ä¹‹å‰åŠ ä¸Šexplainå°±è¡Œäº†ã€‚</p>
<p>###id<br>sqlæ‰§è¡Œé¡ºåºï¼Œä»å¤§åˆ°å°æ‰§è¡Œ</p>
<p>###select_type</p>
<table>
<thead>
<tr>
<th>åå­—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>SIMPLE</td>
<td>ç®€å•æŸ¥è¯¢ï¼Œä¸ä½¿ç”¨unionæˆ–è€…å­æŸ¥è¯¢</td>
</tr>
<tr>
<td>PRIMARY</td>
<td>å¤æ‚æŸ¥è¯¢çš„æœ€å¤–å±‚çš„select</td>
</tr>
<tr>
<td>UNION</td>
<td>UNIONè¯­å¥ä¸­çš„ç¬¬äºŒä¸ªåŠåé¢çš„select</td>
</tr>
<tr>
<td>UNION RESULT</td>
<td>UNIONçš„ç»“æœ</td>
</tr>
<tr>
<td>SUBQUERY</td>
<td>å­æŸ¥è¯¢ä¸­çš„ç¬¬ä¸€ä¸ªselect</td>
</tr>
</tbody>
</table>
<p>###type<br>typeè¡¨ç¤ºæ•°æ®è®¿é—®/è¯»å–çš„æ“ä½œç±»å‹ï¼Œæ˜¾ç¤ºäº†è¿æ¥ä½¿ç”¨äº†å“ªç§ç±»åˆ«,æœ‰æ— ä½¿ç”¨ç´¢å¼•ï¼Œå®ƒæä¾›äº†åˆ¤æ–­æŸ¥è¯¢æ˜¯å¦é«˜æ•ˆçš„é‡è¦ä¾æ®ä¾æ®ã€‚</p>
<table>
<thead>
<tr>
<th>åå­—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>system</td>
<td>constçš„ä¸€ç§ç‰¹ä¾‹ï¼Œè¡¨é‡Œåªæœ‰ä¸€æ¡è®°å½•</td>
</tr>
<tr>
<td>const</td>
<td>whereä¸­æŠŠå¸¸é‡å’Œä¸»é”®æˆ–å”¯ä¸€ç´¢å¼•è¿›è¡Œæ¯”è¾ƒæ—¶</td>
</tr>
<tr>
<td>eq_ref</td>
<td>æ­¤ç±»å‹é€šå¸¸å‡ºç°åœ¨å¤šè¡¨çš„ join æŸ¥è¯¢, è¡¨ç¤ºå¯¹äºå‰è¡¨çš„æ¯ä¸€ä¸ªç»“æœ, éƒ½åªèƒ½åŒ¹é…åˆ°åè¡¨çš„ä¸€è¡Œç»“æœã€‚</td>
</tr>
<tr>
<td>ref</td>
<td>ä¸eq_refç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯refä¸æ˜¯å”¯ä¸€ç´¢å¼•ï¼Œæ­¤ç±»å‹é€šå¸¸å‡ºç°åœ¨å¤šè¡¨çš„ join æŸ¥è¯¢, é’ˆå¯¹äºéå”¯ä¸€æˆ–éä¸»é”®ç´¢å¼•, æˆ–è€…æ˜¯ä½¿ç”¨äº†æœ€å·¦å‰ç¼€è§„åˆ™ç´¢å¼•çš„æŸ¥è¯¢ï¼Œå¯ä»¥ç”¨äºä½¿ç”¨=æˆ–&lt;=&gt;æ“ä½œç¬¦çš„å¸¦ç´¢å¼•çš„åˆ—</td>
</tr>
<tr>
<td>index_merge</td>
<td>è¯¥è”æ¥ç±»å‹è¡¨ç¤ºä½¿ç”¨äº†ç´¢å¼•åˆå¹¶ä¼˜åŒ–æ–¹æ³•ï¼Œ whereä¸­å¯èƒ½æœ‰å¤šä¸ªæ¡ä»¶(æˆ–è€…join)æ¶‰åŠåˆ°å¤šä¸ªå­—æ®µï¼Œå®ƒä»¬ä¹‹é—´è¿›è¡Œ AND æˆ–è€… ORï¼Œé‚£ä¹ˆæ­¤æ—¶å°±æœ‰å¯èƒ½ä¼šä½¿ç”¨åˆ° index merge æŠ€æœ¯</td>
</tr>
<tr>
<td>range</td>
<td>è¡¨ç¤ºä½¿ç”¨ç´¢å¼•èŒƒå›´æŸ¥è¯¢, é€šè¿‡ç´¢å¼•å­—æ®µèŒƒå›´è·å–è¡¨ä¸­éƒ¨åˆ†æ•°æ®è®°å½•ï¼Œ è¿™ä¸ªç±»å‹é€šå¸¸å‡ºç°åœ¨ =, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, &lt;=&gt;, BETWEEN, IN() æ“ä½œä¸­</td>
</tr>
<tr>
<td>index</td>
<td>è¡¨ç¤ºå…¨ç´¢å¼•æ‰«æ(full index scan), å’Œ ALL ç±»å‹ç±»ä¼¼, åªä¸è¿‡ ALL ç±»å‹æ˜¯å…¨è¡¨æ‰«æ, è€Œ index ç±»å‹åˆ™ä»…ä»…æ‰«ææ‰€æœ‰çš„ç´¢å¼•, è€Œä¸æ‰«ææ•°æ®</td>
</tr>
<tr>
<td>ALL</td>
<td>è¡¨ç¤ºå…¨è¡¨æ‰«æ, è¿™ä¸ªç±»å‹çš„æŸ¥è¯¢æ˜¯æ€§èƒ½æœ€å·®çš„æŸ¥è¯¢ä¹‹ä¸€ï¼Œä¸€èˆ¬ä¸ä¼šå‡ºç°</td>
</tr>
</tbody>
</table>
<h3 id="extra"><a href="#extra" class="headerlink" title="extra"></a>extra</h3><table>
<thead>
<tr>
<th>åå­—</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>Using where</td>
<td>åœ¨æŸ¥æ‰¾ä½¿ç”¨ç´¢å¼•çš„æƒ…å†µä¸‹ï¼Œéœ€è¦å›è¡¨å»æŸ¥è¯¢æ‰€éœ€çš„æ•°æ®</td>
</tr>
<tr>
<td>Using index</td>
<td>è¡¨ç¤ºæŸ¥è¯¢åœ¨ç´¢å¼•æ ‘ä¸­å°±å¯æŸ¥æ‰¾æ‰€éœ€æ•°æ®, ä¸ç”¨æ‰«æè¡¨æ•°æ®æ–‡ä»¶, è¯´æ˜æ€§èƒ½ä¸é”™</td>
</tr>
<tr>
<td>Using filesort</td>
<td>å½“SQLä¸­åŒ…å«ORDER BY æ“ä½œï¼Œè€Œä¸”æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆæ’åºæ“ä½œçš„æ—¶å€™ï¼ŒæŸ¥è¯¢ä¼˜åŒ–å™¨ä¸å¾—ä¸é€‰æ‹©ç›¸åº”çš„æ’åºç®—æ³•æ¥å®ç°</td>
</tr>
<tr>
<td>Using temporary</td>
<td>æŸ¥è¯¢æœ‰ä½¿ç”¨ä¸´æ—¶è¡¨, ä¸€èˆ¬å‡ºç°äºæ’åº, åˆ†ç»„å’Œå¤šè¡¨joinçš„æƒ…å†µ, æŸ¥è¯¢æ•ˆç‡ä¸é«˜, å»ºè®®ä¼˜åŒ–</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/21/åˆ†å¸ƒå¼é”/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/21/åˆ†å¸ƒå¼é”/" itemprop="url">åˆ†å¸ƒå¼é”</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-05-21T14:57:12+08:00">
                2018-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/15/è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨è¯»ä¹¦ç¬”è®°ä¹‹å¤åˆ¶-replica/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨è¯»ä¹¦ç¬”è®°ä¹‹å¤åˆ¶-replica/" itemprop="url">è®¾è®¡æ•°æ®å¯†é›†å‹åº”ç”¨è¯»ä¹¦ç¬”è®°ä¹‹å¤åˆ¶(replica)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-05-15T15:24:03+08:00">
                2018-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>CAPç†è®ºï¼šä¸€è‡´æ€§(Consistency)ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition toleranceï¼‰åªèƒ½ä¸‰é€‰äºŒã€‚è¿™ä¸ªè¯´æ³•å®¹æ˜“äº§ç”Ÿä¸€äº›è¯¯è§£ï¼Œæ›´ç§‘å­¦çš„æ˜¯åœ¨Pä¹Ÿå°±æ˜¯ç½‘ç»œå‘ç”Ÿåˆ†åŒºçš„æ—¶å€™ï¼ŒAå’ŒCäºŒé€‰ä¸€ã€‚<a href="http://www.infoq.com/cn/articles/cap-twelve-years-later-how-the-rules-have-changed" target="_blank" rel="external">http://www.infoq.com/cn/articles/cap-twelve-years-later-how-the-rules-have-changed</a></p>
</li>
<li><p>å¤åˆ¶çš„å‡ ç§æ¨¡å‹ï¼š<br>å•ä¸»æ¨¡å¼ï¼Œå¤šä¸»æ¨¡å¼å’Œæ— ä¸»æ¨¡å¼<br>ä¸€èˆ¬æ¥è¯´ï¼Œå•ä¸»æ¨¡å¼å®ç°ä¸Šæœ€ç®€å•ï¼Œä¹Ÿå¾ˆå®¹æ˜“ç†è§£ï¼Œwriteéƒ½åˆ°ä¸»èŠ‚ç‚¹ï¼Œreadåˆ°ä»»ä½•ä¸€ä¸ªä»èŠ‚ç‚¹ï¼Œå¤šä¸»æ¨¡å¼çš„è¯ï¼Œä¸»èŠ‚ç‚¹ä¹‹é—´äº’ç›¸é€šä¿¡äº¤æ¢æ•°æ®ï¼Œwriteåˆ°ä»»ä¸€ä¸ªä¸»èŠ‚ç‚¹ï¼Œreadåˆ°ä»»ä¸€ä»èŠ‚ç‚¹ã€‚æ— ä¸»çš„è¯å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œä¸€èˆ¬é‡‡ç”¨Quorumæœºåˆ¶ï¼ˆè¡¨å†³ï¼‰ï¼Œè¯»å†™éƒ½æ˜¯å¤šä¸ªèŠ‚ç‚¹ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œ5ä¸ªnode,é‚£ä¹ˆä¸€èˆ¬è®¾ç½®è‡³å°‘è¯»ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œå†™ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ ¹æ®æŠ½å±‰åŸç†ï¼Œè‡³å°‘èƒ½å¤Ÿè¯»åˆ°ä¸€ä¸ªèŠ‚ç‚¹çš„æ•°æ®æ˜¯æœ€æ–°çš„ã€‚</p>
</li>
<li><p>å¤åˆ¶çš„åŒæ­¥å’Œå¼‚æ­¥<br>åŒæ­¥å¤åˆ¶ï¼Œä¸€ä¸ªå†™æ“ä½œéœ€è¦å†æ‰€æœ‰éœ€è¦å¤åˆ¶çš„èŠ‚ç‚¹éƒ½responseä»¥åæ‰èƒ½è®¤ä¸ºæ˜¯æ“ä½œæˆåŠŸäº†ï¼Œè€Œå¼‚æ­¥æ“ä½œåœ¨ä¸»èŠ‚ç‚¹å†™æˆåŠŸä»¥åå°±è¿”å›ï¼Œç„¶åå†å¤åˆ¶ç»™ä»èŠ‚ç‚¹ï¼Œæ˜¾ç„¶åè€…æ•ˆç‡é«˜ï¼Œä½†æ˜¯ä¸€è‡´æ€§å°±æ— æ³•ä¿è¯ï¼Œæ•´ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿç†è®ºå°±æ˜¯å®¹é”™å’Œå¦¥åã€‚è¿™ç§ä¸€ç‚¹çš„åŠæ³•ï¼Œå¯ä»¥ä½¿ç”¨åŠåŒæ­¥ï¼Œæ¯”å¦‚ç­‰å¤åˆ¶ç»™ä¸€ä¸ªä»èŠ‚ç‚¹ä»¥åè¿”å›ï¼Œä¹Ÿå°±æ˜¯ç³»ç»Ÿä¸­è‡³å°‘ä¸¤ä¸ªèŠ‚ç‚¹æœ‰æœ€æ–°æ•°æ®ï¼Œé¿å…ä¸»èŠ‚ç‚¹æŒ‚æ‰ä»¥åï¼Œæ²¡æœ‰å‰¯æœ¬å¯ä»¥æ¢å¤ã€‚</p>
</li>
<li><p>å¼‚æ­¥å¤åˆ¶ä¸‹çš„å‡ ç§ä¸€è‡´æ€§<br>read after write consistency<br>æ„æ€å°±æ˜¯å­—é¢æ„æ€<br>ä¸€ç§ç®€å•çš„æƒ…å†µï¼šæˆ‘åœ¨ä¸€ä¸ªç½‘é¡µè¡¨å•ä¸Šæäº¤äº†æ•°æ®ï¼Œä½†æ˜¯æˆ‘åˆ·æ–°é¡µé¢ä»¥åçœ‹åˆ°çš„è¿˜æ˜¯ä¹‹å‰çš„æ•°æ®ï¼Œå› ä¸ºæˆ‘å¯èƒ½è¯»åˆ°çš„æ˜¯ä»åº“çš„æ•°æ®ã€‚è§£å†³åŠæ³•ä¸€èˆ¬æ˜¯è¯·æ±‚ä¸»åº“ï¼Œå¦‚æœä¸€ä¸ªuseræ˜¯åœ¨è°ƒç”¨è‡ªå·±çš„ä¿¡æ¯ï¼ˆæˆ–è€…è¿™ä¸ªç”¨æˆ·æœ‰å¯èƒ½æ”¹åŠ¨çš„ä¿¡æ¯ï¼‰æ‰‹åŠ¨bindä¸€ä¸‹masterã€‚è¿™æ ·ä¸€ä¸‹å­ä¸»åº“å‹åŠ›å°±å¤§äº†ï¼Œæ¯”å¦‚ç”¨æˆ·ä¿¡æ¯è¡¨ï¼ŒåŸºæœ¬éƒ½æ˜¯åœ¨è°ƒç”¨è‡ªå·±ä¿¡æ¯ã€‚é‚£ä¹ˆå¯ä»¥å¢åŠ ä¸€ä¸ªæ—¶é—´æˆ³ï¼Œçœ‹è¿™æ¡è®°å½•çš„ä¸Šæ¬¡ä¿®æ”¹æ—¶é—´ï¼Œå†å¾—å‡ºä¸€ä¸ªå¼‚æ­¥å¤åˆ¶çš„æ—¶é—´çš„upper95æˆ–è€…upper99çš„å€¼æ¯”å¦‚1minï¼Œé‚£ä¹ˆè¶…è¿‡è¿™ä¸ªæ—¶é—´æˆ‘ä»¬å¯ä»¥è®¤ä¸ºå»è¯»ä»åº“ä¹Ÿæ˜¯å¯ä»¥ä¿è¯ä¸€è‡´æ€§çš„ï¼ˆå½“ç„¶è¿™é‡Œè¿˜æ˜¯ä¸€ä¸ªtradeoff,æç«¯æƒ…å†µä¸‹è¿˜æ˜¯ä¸èƒ½ä¿è¯ä¸€è‡´æ€§ï¼‰ã€‚å¦ä¸€ç§åœ¨åº”ç”¨ä»£ç å®ç°çš„æ–¹æ³•æ˜¯åœ¨å®¢æˆ·ç«¯è®°å½•ä¸Šæ¬¡å‘é€writeæ“ä½œçš„æ—¶é—´ã€‚</p>
<p>monotonic reads<br>ä¿è¯è¯»åˆ°ä¸€ä¸ªæ—¶é—´ç‚¹çš„æ•°æ®ä»¥åä¸ä¼šå†è¯»åˆ°è¿™ä¸ªæ—¶é—´ç‚¹ä»¥å‰çš„æ•°æ®<br>è¿™ç§ä¸€èˆ¬å‡ºç°åœ¨ä¸åŒçš„å‰¯æœ¬çš„å¤åˆ¶é€Ÿåº¦ä¸ä¸€æ ·ï¼Œç„¶åè¯»åˆ°äº†ä¸€ä¸ªå‰¯æœ¬ä¿®æ”¹ä»¥åçš„æ•°æ®åï¼Œåˆè¯»åˆ°äº†å¦ä¸€ä¸ªå‰¯æœ¬çš„ä¿®æ”¹ä»¥å‰çš„æ•°æ®ã€‚è§£å†³æ–¹æ³•é€šå¸¸ä¸ºä¿è¯åŒä¸€ä¸ªç”¨æˆ·åœ¨æŸä¸ªæ—¶é—´æ®µå†…çš„è¯»éƒ½æ‰“åˆ°ä¸€ä¸ªå‰¯æœ¬ä¸Š</p>
<p>consistent prefix reads<br>ä¿è¯å› æœå¾‹ï¼Œè§£å†³æ–¹æ³•ä¸€èˆ¬æ˜¯å…·æœ‰å› æœå…³ç³»çš„æ•°æ®å†™å…¥ä¿è¯åœ¨ä¸€ä¸ªnode</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/08/curioæºç è§£æ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/08/curioæºç è§£æ/" itemprop="url">curioæºç è§£æ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-05-08T11:02:51+08:00">
                2018-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>  ä¸ºäº†è§£å†³é«˜å¹¶å‘é—®é¢˜ï¼Œè¿™å‡ å¹´åç¨‹ï¼ˆæˆ–è€…çº¤ç¨‹ï¼‰å¾—åˆ°äº†å¾ˆå¤§çš„å‘å±•ï¼Œå„ç§å„æ ·çš„åº“å±‚å‡ºä¸ç©·ã€‚è€Œgolangåœ¨è¯­è¨€å±‚é¢é€šè¿‡goå…³é”®å­—ç”Ÿæˆäº†ä¸€ä¸ªgoroutineï¼Œä½¿ç”¨channelå®ç°goroutineä¹‹é—´çš„é€šä¿¡ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šäº†é™ä½äº†ç¨‹åºå‘˜çš„å¿ƒæ™ºè´Ÿæ‹…ã€‚è¿™æ–¹é¢ï¼Œpythonä¹Ÿåšäº†å¾ˆå¤§åŠªåŠ›ï¼Œç‰¹åˆ«æ˜¯åˆ°äº†python3.5ä»¥åï¼Œpep429æå‡ºäº†asyncå’Œawaitï¼Œä»è€Œæ˜ç¡®äº†generator_base_coroutine å’Œnative_coroutineä¹‹é—´çš„ç•Œé™ï¼Œå¹¶ä¸”asyncioè¿™ä¸ªåŒ…è¢«å¼•å…¥æ ‡å‡†åº“ã€‚ä½†æ˜¯æˆ‘ä»Šå¤©è¦è®²çš„æ˜¯David Beazleyå†™çš„ä¸€ä¸ªcurioï¼Œä»–è§‰å¾—asyncioçš„apiä¸å¤Ÿç®€æ´ï¼Œäºæ˜¯å°±è‡ªå·±æ’¸äº†ä¸€ä¸ªï¼Œæˆ‘è§‰å¾—asyncioçš„futureï¼Œtaskï¼Œpromiseç­‰ç­‰ç¡®å®æ¦‚å¿µæœ‰ç‚¹ä¹±ï¼Œåé¢å†æŒ–ä¸ªå‘ï¼Œè®²è®²asyncioã€‚<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/05/08/curioæºç è§£æ/#more" rel="contents">
              é˜…è¯»å…¨æ–‡ &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/04/28/è¿›ç¨‹é—´é€šä¿¡ä¹‹ç®¡é“/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/è¿›ç¨‹é—´é€šä¿¡ä¹‹ç®¡é“/" itemprop="url">è¿›ç¨‹é—´é€šä¿¡ä¹‹ç®¡é“</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2018-04-28T15:45:48+08:00">
                2018-04-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>æœ€è¿‘çœ‹gunicornçš„master-workersçš„è¿›ç¨‹ç®¡ç†æºç ï¼Œå…¶ä¸­éƒ¨åˆ†é€šä¿¡æ˜¯é€šè¿‡ç®¡é“çš„æ–¹å¼è¿›è¡Œçš„ï¼Œäºæ˜¯å¤ä¹ äº†ä¸€ä¸‹ã€ŠUNIXç½‘ç»œç¼–ç¨‹å·2ï¼šè¿›ç¨‹é—´é€šä¿¡ã€‹ã€‚<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/04/28/è¿›ç¨‹é—´é€šä¿¡ä¹‹ç®¡é“/#more" rel="contents">
              é˜…è¯»å…¨æ–‡ &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/slark.jpeg"
               alt="Edwin" />
          <p class="site-author-name" itemprop="name">Edwin</p>
           
              <p class="site-description motion-element" itemprop="description">rua! rua! rua!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Edwin</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  










  






  





  

  

  

  

  

</body>
</html>

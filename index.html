<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/slark.jpeg?v=5.1.1" />






<meta name="description" content="rua! rua! rua!">
<meta property="og:type" content="website">
<meta property="og:title" content="Slark">
<meta property="og:url" content="http://slark.info/index.html">
<meta property="og:site_name" content="Slark">
<meta property="og:description" content="rua! rua! rua!">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Slark">
<meta name="twitter:description" content="rua! rua! rua!">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://slark.info/"/>





  <title>Slark</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  















  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Slark</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">coding and thinking</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/14/python描述器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/14/python描述器/" itemprop="url">python描述器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-14T17:02:57+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>描述器是一个对象的属性，访问控制被描述器协议的方法重写，这些方法是<code>__get__()</code>，<code>__set__()</code>和<code>__delete__()</code>，有这些方法的对象叫做描述器</p>
<h3 id="访问控制"><a href="#访问控制" class="headerlink" title="访问控制"></a>访问控制</h3><p>在讲描述器之前，先聊一下python属性的访问控制，会涉及到python的几个魔术方法。<br><code>__getattribute__</code>:获取属性都会调用这个方法（新式类中，2.X继承object,3.x都是新式类）<br><code>__getattr__</code>:当获取一个不存在的属性的时候会调用这个方法。<br>举个例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">In [<span class="number">1</span>]: <span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">   ...:     <span class="function"><span class="keyword">def</span> <span class="title">__getattr__</span><span class="params">(self, item)</span>:</span></div><div class="line">   ...:         <span class="keyword">return</span> <span class="number">1</span></div><div class="line">   ...:</div><div class="line"></div><div class="line">In [<span class="number">2</span>]: a = A()</div><div class="line"></div><div class="line">In [<span class="number">3</span>]: a.x</div><div class="line">Out[<span class="number">3</span>]: <span class="number">1</span></div></pre></td></tr></table></figure>
<p>既然<code>__getattribute__</code>是获取属性的默认行为，那么可以通过重写<code>__getattribute__</code>来对属性获取进行自定义行为，但是需要注意的是在<code>__getattribute__</code>内部进行属性获取的时候，一定要调用父类的<code>__getattribute__</code>，不然就陷入无限循环了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span><span class="params">(object)</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__getattribute__</span><span class="params">(self, item)</span>:</span></div><div class="line">        <span class="keyword">return</span> self.item</div><div class="line">A().<span class="string">'xx'</span></div><div class="line">RuntimeError: maximum recursion depth exceeded</div></pre></td></tr></table></figure>
<p><code>__getattribute__</code>获取属性的顺序是，先从实例的<strong>dict</strong>中找，然后是类，父类的<strong>dict</strong>中找。<br>如果从这个访问控制的角度看，目前我们的手段都是针对所有属性的，似乎缺少一种更细粒度的控制，描述器就可以让我们针对特定属性进行操作。</p>
<h3 id="描述器的调用"><a href="#描述器的调用" class="headerlink" title="描述器的调用"></a>描述器的调用</h3><p>对于一个实例obj,当我们调用obj.d的时候，根据d的描述器类型<br>（实现了<code>__get__</code>和<code>__set__</code>的是资料描述器，只实现了<code>__set__</code>是非资料描述器）<br>有以下优先级：资料描述器&gt;实例变量&gt;非资料描述器&gt;<code>__getattr__</code><br>如果调用了描述器，那么<code>__getattribute__</code>会把obj.x变成<br>type(obj).<strong>dict</strong>[‘x’].<strong>get</strong>(obj, type(obj))<br>所以，如果我们重写了<code>__getattribute__</code>方法会阻止描述器的调用</p>
<h3 id="描述器的应用"><a href="#描述器的应用" class="headerlink" title="描述器的应用"></a>描述器的应用</h3><h5 id="property"><a href="#property" class="headerlink" title="property"></a>property</h5><p>平时我们写代码的时候应该没少用property这个装饰器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class person(object):</div><div class="line">    </div><div class="line">    def __init__(self, first_name, last_name):</div><div class="line">    self.first_name = first_name</div><div class="line">    self.last_name = last_name</div><div class="line">    </div><div class="line">    @property</div><div class="line">    def full_name(self):</div><div class="line">        return &apos;&#123;&#125;.&#123;&#125;&apos;.format(first_name, last_name)</div></pre></td></tr></table></figure>
<p>我们看一下一个python的等价实现(来自python的doc)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">class property(object):</div><div class="line">    &quot;Emulate PyProperty_Type() in Objects/descrobject.c&quot;</div><div class="line"></div><div class="line">    def __init__(self, fget=None, fset=None, fdel=None, doc=None):</div><div class="line">        self.fget = fget</div><div class="line">        self.fset = fset</div><div class="line">        self.fdel = fdel</div><div class="line">        self.__doc__ = doc</div><div class="line"></div><div class="line">    def __get__(self, obj, objtype=None):</div><div class="line">        if obj is None:</div><div class="line">            return self</div><div class="line">        if self.fget is None:</div><div class="line">            raise AttributeError, &quot;unreadable attribute&quot;</div><div class="line">        return self.fget(obj)</div><div class="line"></div><div class="line">    def __set__(self, obj, value):</div><div class="line">        if self.fset is None:</div><div class="line">            raise AttributeError, &quot;can&apos;t set attribute&quot;</div><div class="line">        self.fset(obj, value)</div><div class="line"></div><div class="line">    def __delete__(self, obj):</div><div class="line">        if self.fdel is None:</div><div class="line">            raise AttributeError, &quot;can&apos;t delete attribute&quot;</div><div class="line">        self.fdel(obj)</div><div class="line"></div><div class="line">    def getter(self, fget):</div><div class="line">        return type(self)(fget, self.fset, self.fdel, self.__doc__)</div><div class="line"></div><div class="line">    def setter(self, fset):</div><div class="line">        return type(self)(self.fget, fset, self.fdel, self.__doc__)</div><div class="line"></div><div class="line">    def deleter(self, fdel):</div><div class="line">        return type(self)(self.fget, self.fset, fdel, self.__doc__)</div></pre></td></tr></table></figure>
<p>这里property被作为一个类装饰器使用，本文不对装饰器进行展开，可以理解为property(full_name),然后full_name就是一个property类型的一个实例，由于property实现了<code>__get__</code>,<code>__set__</code> 所以此时full_name是一个资料描述器，优先级最高。从property的<strong>init</strong>方法我们可以看出，此时被property装饰的full_name方法其实就是fget,这也就是为什么我们平时在对property进行set操作的时候需要加上如下代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@full_name.setter</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">full_name</span><span class="params">(self, full_name)</span>:</span></div><div class="line">    self.full_name = full_name</div></pre></td></tr></table></figure>
<p>这时候设置了fset方法不会执行如下代码了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> self.fset <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">           <span class="keyword">raise</span> AttributeError, <span class="string">"can't set attribute"</span></div></pre></td></tr></table></figure>
<p>######cached_property</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, func, name=None, doc=None)</span>:</span></div><div class="line">    self.__name__ = name <span class="keyword">or</span> func.__name__</div><div class="line">    self.__module__ = func.__hmodule__</div><div class="line">    self.__doc__ = doc <span class="keyword">or</span> func.__doc__</div><div class="line">    self.func = func</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__set__</span><span class="params">(self, obj, value)</span>:</span></div><div class="line">    obj.__dict__[self.__name__] = value</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__get__</span><span class="params">(self, obj, type=None)</span>:</span></div><div class="line">    <span class="keyword">if</span> obj <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> self</div><div class="line">    value = obj.__dict__.get(self.__name__, _missing)</div><div class="line">    <span class="keyword">if</span> value <span class="keyword">is</span> _missing:</div><div class="line">        value = self.func(obj)</div><div class="line">        obj.__dict__[self.__name__] = value</div><div class="line">    <span class="keyword">return</span> value</div></pre></td></tr></table></figure>
<p>使用property就已经实现了懒加载（只有调用obj.x的时候才会执行x内部的代码），那么我们顺带抽出flask的cached_property来讲如何实现x结果的缓存。其实很简单，就是把结果放到实例的<strong>dict</strong>里面，每次<strong>get</strong>的时候先去实例的<strong>dict</strong>里找，如果miss,那么再去执行x。所以说，对于资料描述器，是可以覆盖实例属性的。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/14/python-localcache的一些实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/14/python-localcache的一些实现/" itemprop="url">python localcache的一些实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-14T11:12:50+08:00">
                2018-06-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/11/raft论文阅读笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/11/raft论文阅读笔记/" itemprop="url">raft论文阅读笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-11T11:54:08+08:00">
                2018-06-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一.选举过程</p>
<p>when:<br>如果一个follower节点在一段时间（election timeout）内没有收到leader的心跳AppendEntries RPC(这个rpc里面不带有log),那么它就会发起选举<br>how:<br>follower节点先increase自己的term,然后把自己标记为candidate,投票自己，然后向所有节点发出一个RequestVote的rpc</p>
<p>三种结果：</p>
<ol>
<li>获得大多数人的vote， 赢得选举，然后向所有节点发送心跳，确认自己的leader地位。</li>
<li>收到某个节点发来的心跳（表明该节点宣布成为leader），比较心跳的term，如果大于等于自己的term，那么承认选举结果，否则保持candidate状态。</li>
<li>在一个term内， 没有节点获取多数票 ，选举流产，increase自己的term，发起下一轮的选举，需要额外措施保证这种情况不会无限循环。</li>
</ol>
<p>二.日志复制<br>leader会维持每个follower的 nextIndex来表明leader需要向follower发送的下一个log entry的index。<br>在一个节点刚选举为leader的时候，所有的nextIndex被初始化为自己的最后一条log entry。 在leader发送AppendEntries RPC的时候，<br>如果follower的log一致性检查不通过，说明leader需要减小对该follower的nextIndex（每次减1）,多次这个过程后，会找到合适的nextIndex,并且保持leader和<br>follower的一致性。<br>很明显，这样的做法可能会导致rpc次数过多，所以有个优化手段：每次减小的是整个term的entry数目，而不是一次rpc减小一个entry。</p>
<p>三.安全性</p>
<p>在日志复制中，完全是根据leader的日志进行复制的，回覆盖follower，那么我们需要一个机制保证leader的日志是完整的（包含了之前所有term的日志<br>也就是 <code>Leader Completeness Property</code></p>
<ol>
<li><p>选举过程的限制<br>在所有的leader_based的一致性算法中，leader最终肯定是要拥有全量committed日志的。可以在选举的时候标记leader的缺失日志，然后再选举过程中或者选举结束后<br>将日志传到leader，但是raft将拥有全量日志作为可以被选举为leader先决条件，也就是在选举的RequestVote Rpc 中带上candidate的日志信息，然后<br>投票者会否决掉日志落后于自己的candidate。<br>比较的过程根据term和index,优先比较term,然后比较index</p>
</li>
<li><p>Committing entries from previous terms（指不提交之前term的log entry）</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/08/pipenv初体验/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/08/pipenv初体验/" itemprop="url">pipenv初体验</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-08T16:58:22+08:00">
                2018-06-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>相信大多数python开发者都接触过pip+virtualenv的包管理和虚拟环境管理方案。</p>
<h3 id="pip-virtualenv"><a href="#pip-virtualenv" class="headerlink" title="pip+virtualenv"></a>pip+virtualenv</h3><p>这个方案中，我们一般先手动创建一个虚拟环境(安装了virtualenvwrapper这个wrapper可以让操作更简单)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">➜  ~ mkvirtualenv test</div><div class="line">Using base prefix &apos;/Library/Frameworks/Python.framework/Versions/3.6&apos;</div><div class="line">New python executable in /Users/Edwin/.virtualenvs/test/bin/python3.6</div><div class="line">Also creating executable in /Users/Edwin/.virtualenvs/test/bin/python</div><div class="line">Installing setuptools, pip, wheel...done.</div><div class="line">(test) ➜  ~</div></pre></td></tr></table></figure></p>
<p>然后通过requirement.txt文件来管理依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(test) ➜  ~ pip install -r requirements.txt</div></pre></td></tr></table></figure></p>
<p>切换虚拟环境：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(test) ➜  ~ workon slark</div><div class="line">(slark)➜  ~</div></pre></td></tr></table></figure>
<p> 这个方案存在一些问题，比如：<br> 1.依赖需要手动更新到requirem.txt，来保持多个环境的依赖一致<br> 2.如果不同环境依赖不同要使用多个requirement.txt，比如测试和线上，那么一般会要用requirement.txt和dev_requirement.txt<br> 3.删除依赖的话不能删除依赖的依赖（比较绕）</p>
<h3 id="pipenv"><a href="#pipenv" class="headerlink" title="pipenv"></a>pipenv</h3><p>早就听说requests 作者 Kenneth Reitz搞了一套新的依赖管理工具，今天兴致来了就折腾一波。<br>pip install在一个空目录自动创建 Pipfile和Pipfile.lock,<br>可以 –python 2.7.14等来指定使用哪个python版本来创建虚拟环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">➜  ~ mkdir pipenv_test</div><div class="line">➜  ~ cd pipenv_test</div><div class="line">➜  pipenv_test pipenv install</div><div class="line">Creating a virtualenv for this project…</div><div class="line">Using /Library/Frameworks/Python.framework/Versions/3.6/bin/python3.6 (3.6.0) to create virtualenv…</div><div class="line">⠋Already using interpreter /Library/Frameworks/Python.framework/Versions/3.6/bin/python3.6</div><div class="line">Using base prefix &apos;/Library/Frameworks/Python.framework/Versions/3.6&apos;</div><div class="line">New python executable in /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python3.6</div><div class="line">Also creating executable in /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python</div><div class="line">Installing setuptools, pip, wheel...done.</div><div class="line"></div><div class="line">Virtualenv location: /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE</div><div class="line">Creating a Pipfile for this project…</div><div class="line">Pipfile.lock not found, creating…</div><div class="line">Locking [dev-packages] dependencies…</div><div class="line">Locking [packages] dependencies…</div><div class="line">Updated Pipfile.lock (ca72e7)!</div><div class="line">Installing dependencies from Pipfile.lock (ca72e7)…</div><div class="line">  🐍   ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 0/0 — 00:00:00</div><div class="line">To activate this project&apos;s virtualenv, run the following:</div><div class="line"> $ pipenv shell</div><div class="line">➜  pipenv_test</div></pre></td></tr></table></figure>
<p>pipenv shell激活虚拟环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">➜  pipenv_test pipenv shell</div><div class="line">Spawning environment shell (/bin/zsh). Use &apos;exit&apos; to leave.</div><div class="line">. /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/activate</div><div class="line">➜  pipenv_test . /Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/activate</div><div class="line">(pipenv_test-e7bT0qHE) ➜  pipenv_test</div></pre></td></tr></table></figure>
<p>查看一下此时python已经指向虚拟环境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(pipenv_test-e7bT0qHE) ➜  pipenv_test which python</div><div class="line">/Users/Edwin/.virtualenvs/pipenv_test-e7bT0qHE/bin/python</div><div class="line">(pipenv_test-e7bT0qHE) ➜  pipenv_test</div></pre></td></tr></table></figure>
<p>尝试安装一下grpcio</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(pipenv_test-e7bT0qHE) ➜  pipenv_test pipenv install grpcio</div><div class="line">Installing grpcio…</div><div class="line">Collecting grpcio</div><div class="line">  Using cached https://files.pythonhosted.org/packages/68/57/da122cbfc1b7815381480b23044fff06b90f58c1be9310e68c2d6b1d623c/grpcio-1.12.1-cp36-cp36m-macosx_10_7_intel.whl</div><div class="line">Collecting six&gt;=1.5.2 (from grpcio)</div><div class="line">  Using cached https://files.pythonhosted.org/packages/67/4b/141a581104b1f6397bfa78ac9d43d8ad29a7ca43ea90a2d863fe3056e86a/six-1.11.0-py2.py3-none-any.whl</div><div class="line">Installing collected packages: six, grpcio</div><div class="line">Successfully installed grpcio-1.12.1 six-1.11.0</div><div class="line"></div><div class="line">Adding grpcio to Pipfile&apos;s [packages]…</div><div class="line">Pipfile.lock (ca72e7) out of date, updating to (75c298)…</div><div class="line">Locking [dev-packages] dependencies…</div><div class="line">Locking [packages] dependencies…</div><div class="line">Updated Pipfile.lock (75c298)!</div><div class="line">Installing dependencies from Pipfile.lock (75c298)…</div><div class="line">  🐍   ▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉▉ 2/2 — 00:00:00</div><div class="line">(pipenv_test-e7bT0qHE) ➜  pipenv_test</div></pre></td></tr></table></figure>
<p>Pipfile.lock上记录了grocio的hash。</p>
<p>貌似pipenv现在还不可以卸载依赖的依赖，但是因为 pipenv graph –json 提供了详细的依赖关系，所以可以通过一些脚本实现。</p>
<p>最后附上一个pipenv的pdf文档：<a href="https://media.readthedocs.org/pdf/pipenv/stable/pipenv.pdf" target="_blank" rel="external">https://media.readthedocs.org/pdf/pipenv/stable/pipenv.pdf</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/04/TCP-keepalive与http-keepalive/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/TCP-keepalive与http-keepalive/" itemprop="url">TCP keepalive与http keepalive</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-04T18:33:31+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>计算机里有很多术语听着一样，然而实际内容（比如一致性，到处都是一致性，然而表达的是完全不同的意思）差别很大，本文聊一下HTTP的keep-alive 和TCP的keep-alive，也许有同学要说了。。。啊！原来这两个不是一个东西？</p>
<h3 id="TCP-keep-alive"><a href="#TCP-keep-alive" class="headerlink" title="TCP keep-alive"></a>TCP keep-alive</h3><p>先来看TCP的keep-alive，其实相当于一个心跳机制，在一个TCP链接长时间没有数据发送时，会自动发一个空数据报文发过去，如果对方没有响应，并且重试多次以后可以认为链接丢失。<br>linux内核中有三个参数影响keep-alive行为。<br>1.net.ipv4.tcpkeepaliveintvl = 75<br>表示两次重试之间的时间间隔<br>2.net.ipv4.tcpkeepaliveprobes = 9<br>表示重试次数<br>3.net.ipv4.tcpkeepalivetime = 7200<br>表示空闲多少时间以后开始发送心跳包</p>
<p>对应TCP socket中<br>TCPKEEPCNT: 覆盖 tcpkeepaliveprobes<br>TCPKEEPIDLE: 覆盖 tcpkeepalivetime<br>TCPKEEPINTVL: 覆盖 tcpkeepalive_intvl<br>TCP socket中默认不打开keepalive,需要设置SO_KEEPALIVE选项</p>
<h3 id="HTTP-keep-alive"><a href="#HTTP-keep-alive" class="headerlink" title="HTTP keep-alive"></a>HTTP keep-alive</h3><p>http的keep-alive的目的是延长TCP连接的存活时间,从而在一个TCP连接上发送多个HTTP请求。正常情况下，我一个http请求完成我就断开TCP连接，但是在设置keep-alive以后（http1.1默认开启），就会继续保持这个连接keepalive_timeout时间。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/06/04/mysql执行计划备忘/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/04/mysql执行计划备忘/" itemprop="url">mysql执行计划备忘</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-04T16:11:13+08:00">
                2018-06-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在分析sql执行情况的时候，我们常常会用到explain语句。因为内容比较琐碎，特在此记录一下。</p>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><p>很简单，在sql语句之前加上explain就行了。</p>
<p>###id<br>sql执行顺序，从大到小执行</p>
<p>###select_type</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>SIMPLE</td>
<td>简单查询，不使用union或者子查询</td>
</tr>
<tr>
<td>PRIMARY</td>
<td>复杂查询的最外层的select</td>
</tr>
<tr>
<td>UNION</td>
<td>UNION语句中的第二个及后面的select</td>
</tr>
<tr>
<td>UNION RESULT</td>
<td>UNION的结果</td>
</tr>
<tr>
<td>SUBQUERY</td>
<td>子查询中的第一个select</td>
</tr>
</tbody>
</table>
<p>###type<br>type表示数据访问/读取的操作类型，显示了连接使用了哪种类别,有无使用索引，它提供了判断查询是否高效的重要依据依据。</p>
<table>
<thead>
<tr>
<th>名字</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>system</td>
<td>const的一种特例，表里只有一条记录</td>
</tr>
<tr>
<td>const</td>
<td>where中把常量和主键或唯一索引进行比较时</td>
</tr>
<tr>
<td>eq_ref</td>
<td>此类型通常出现在多表的 join 查询, 表示对于前表的每一个结果, 都只能匹配到后表的一行结果。</td>
</tr>
<tr>
<td>ref</td>
<td>与eq_ref类似，不同的是ref不是唯一索引，此类型通常出现在多表的 join 查询, 针对于非唯一或非主键索引, 或者是使用了最左前缀规则索引的查询，可以用于使用=或&lt;=&gt;操作符的带索引的列</td>
</tr>
<tr>
<td>index_merge</td>
<td>该联接类型表示使用了索引合并优化方法， where中可能有多个条件(或者join)涉及到多个字段，它们之间进行 AND 或者 OR，那么此时就有可能会使用到 index merge 技术</td>
</tr>
<tr>
<td>range</td>
<td>表示使用索引范围查询, 通过索引字段范围获取表中部分数据记录， 这个类型通常出现在 =, &lt;&gt;, &gt;, &gt;=, &lt;, &lt;=, IS NULL, &lt;=&gt;, BETWEEN, IN() 操作中</td>
</tr>
<tr>
<td>index</td>
<td>表示全索引扫描(full index scan), 和 ALL 类型类似, 只不过 ALL 类型是全表扫描, 而 index 类型则仅仅扫描所有的索引, 而不扫描数据</td>
</tr>
<tr>
<td>ALL</td>
<td>表示全表扫描, 这个类型的查询是性能最差的查询之一，一般不会出现</td>
</tr>
</tbody>
</table>
<h3 id="extra"><a href="#extra" class="headerlink" title="extra"></a>extra</h3><table>
<thead>
<tr>
<th>名字</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>Using where</td>
<td>在查找使用索引的情况下，需要回表去查询所需的数据</td>
</tr>
<tr>
<td>Using index</td>
<td>表示查询在索引树中就可查找所需数据, 不用扫描表数据文件, 说明性能不错</td>
</tr>
<tr>
<td>Using filesort</td>
<td>当SQL中包含ORDER BY 操作，而且无法利用索引完成排序操作的时候，查询优化器不得不选择相应的排序算法来实现</td>
</tr>
<tr>
<td>Using temporary</td>
<td>查询有使用临时表, 一般出现于排序, 分组和多表join的情况, 查询效率不高, 建议优化</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/21/分布式锁/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/21/分布式锁/" itemprop="url">分布式锁</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-21T14:57:12+08:00">
                2018-05-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/15/设计数据密集型应用读书笔记之复制-replica/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/15/设计数据密集型应用读书笔记之复制-replica/" itemprop="url">设计数据密集型应用读书笔记之复制(replica)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-15T15:24:03+08:00">
                2018-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ol>
<li><p>CAP理论：一致性(Consistency)、可用性（Availability）分区容错性（Partition tolerance）只能三选二。这个说法容易产生一些误解，更科学的是在P也就是网络发生分区的时候，A和C二选一。<a href="http://www.infoq.com/cn/articles/cap-twelve-years-later-how-the-rules-have-changed" target="_blank" rel="external">http://www.infoq.com/cn/articles/cap-twelve-years-later-how-the-rules-have-changed</a></p>
</li>
<li><p>复制的几种模型：<br>单主模式，多主模式和无主模式<br>一般来说，单主模式实现上最简单，也很容易理解，write都到主节点，read到任何一个从节点，多主模式的话，主节点之间互相通信交换数据，write到任一个主节点，read到任一从节点。无主的话复杂度比较高，一般采用Quorum机制（表决），读写都是多个节点，举个例子，5个node,那么一般设置至少读三个节点，写三个节点，那么根据抽屉原理，至少能够读到一个节点的数据是最新的。</p>
</li>
<li><p>复制的同步和异步<br>同步复制，一个写操作需要再所有需要复制的节点都response以后才能认为是操作成功了，而异步操作在主节点写成功以后就返回，然后再复制给从节点，显然后者效率高，但是一致性就无法保证，整个分布式系统理论就是容错和妥协。这种一点的办法，可以使用半同步，比如等复制给一个从节点以后返回，也就是系统中至少两个节点有最新数据，避免主节点挂掉以后，没有副本可以恢复。</p>
</li>
<li><p>异步复制下的几种一致性<br>read after write consistency<br>意思就是字面意思<br>一种简单的情况：我在一个网页表单上提交了数据，但是我刷新页面以后看到的还是之前的数据，因为我可能读到的是从库的数据。解决办法一般是请求主库，如果一个user是在调用自己的信息（或者这个用户有可能改动的信息）手动bind一下master。这样一下子主库压力就大了，比如用户信息表，基本都是在调用自己信息。那么可以增加一个时间戳，看这条记录的上次修改时间，再得出一个异步复制的时间的upper95或者upper99的值比如1min，那么超过这个时间我们可以认为去读从库也是可以保证一致性的（当然这里还是一个tradeoff,极端情况下还是不能保证一致性）。另一种在应用代码实现的方法是在客户端记录上次发送write操作的时间。</p>
<p>monotonic reads<br>保证读到一个时间点的数据以后不会再读到这个时间点以前的数据<br>这种一般出现在不同的副本的复制速度不一样，然后读到了一个副本修改以后的数据后，又读到了另一个副本的修改以前的数据。解决方法通常为保证同一个用户在某个时间段内的读都打到一个副本上</p>
<p>consistent prefix reads<br>保证因果律，解决方法一般是具有因果关系的数据写入保证在一个node</p>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/05/08/curio源码解析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/05/08/curio源码解析/" itemprop="url">curio源码解析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-05-08T11:02:51+08:00">
                2018-05-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>  为了解决高并发问题，这几年协程（或者纤程）得到了很大的发展，各种各样的库层出不穷。而golang在语言层面通过go关键字生成了一个goroutine，使用channel实现goroutine之间的通信，很大程度上了降低了程序员的心智负担。这方面，python也做了很大努力，特别是到了python3.5以后，pep429提出了async和await，从而明确了generator_base_coroutine 和native_coroutine之间的界限，并且asyncio这个包被引入标准库。但是我今天要讲的是David Beazley写的一个curio，他觉得asyncio的api不够简洁，于是就自己撸了一个，我觉得asyncio的future，task，promise等等确实概念有点乱，后面再挖个坑，讲讲asyncio。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/05/08/curio源码解析/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://slark.info/2018/04/28/进程间通信之管道/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Edwin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/slark.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Slark">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/04/28/进程间通信之管道/" itemprop="url">进程间通信之管道</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-28T15:45:48+08:00">
                2018-04-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>最近看gunicorn的master-workers的进程管理源码，其中部分通信是通过管道的方式进行的，于是复习了一下《UNIX网络编程卷2：进程间通信》。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/04/28/进程间通信之管道/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/slark.jpeg"
               alt="Edwin" />
          <p class="site-author-name" itemprop="name">Edwin</p>
           
              <p class="site-description motion-element" itemprop="description">rua! rua! rua!</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">16</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Edwin</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  










  






  





  

  

  

  

  

</body>
</html>
